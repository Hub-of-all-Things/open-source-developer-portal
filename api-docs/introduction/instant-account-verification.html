<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Instant account verification | Hub of All Things API</title><meta name=description content="Programmatically verify a bank to initiate a bank transfer."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.a953.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.e78f.js></script><script src=https://cdn.statuspage.io/se-v2.js></script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href=https://www.hubofallthings.com class="logo icon-logo-hat-white">Hub of All Things</a><div class=hamburger><a href="https://hubofallthings.com/main/what-is-the-hat/">What is the HAT</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href="https://www.hatdex.org/">Data Exchange</a> <a href="https://hatcommunity.org/">Community Foundation</a> <a href="/">Developers</a> <a href="http://hubofallthings.com/hat-rd/">Research</a> <a class="btn primary" href="https://hubofallthings.com/main/what-is-the-hat/">Learn More</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/api-docs/" class=active>API docs</a> <a href=https://github.com/Hub-of-all-Things>Repositories</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav active"><section><h6>Introduction</h6><ul></ul><h6>Endpoints</h6><ul></ul><h6>Other Resources</h6><ul><li class=external-link><a href=https://hatters.hubofallthings.com target=_blank><span class=icon-sidenav-option>Get a HAT</span></a></li><li class=external-link><a href=http://forum.hatcommunity.org/c/developers target=_blank><span class=icon-sidenav-option>Developer Forum</span></a></li></ul></section></nav></section><section class=cnt-two-col__content><h1 id=funding-source-verification>Funding source verification</h1><h2 id=instant-account-verification-iav>Instant account verification (IAV)</h2><p>Instant Account Verification (IAV) gives you the ability to add and verify a Customer&rsquo;s bank account in a matter of seconds, which is much faster than the multiple days required for micro-deposits to transfer and then be verified by the Customer. Your application will utilize the client-side <code>dwolla.js</code> JavaScript library to render the IAV flow within a container in your application.</p><ol class=alerts><li class="alert icon-alert-info">This article will walk through IAV functionality using dwolla.js which is only available for Access API integrations. For more information about the Access API, please <a href=https://www.dwolla.com/contact>contact sales</a>.</li></ol><h3 id=step-1-generate-a-single-use-iav-token-for-a-customer>Step 1: Generate a single-use IAV token for a Customer</h3><p>To initiate the IAV flow, dwolla.js requires a single-use IAV token for a Customer. Your server initiates a POST request to Dwolla, specifying for which Customer you want to add/verify a bank account. Dwolla will respond with a non-expiring single-use <code>token</code>. This IAV token will be sent to the client and used to authenticate the HTTP request asking Dwolla to render the IAV flow.</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl -X POST 
\ -H "Content-Type: application/vnd.dwolla.v1.hal+json"
\ -H "Accept: application/vnd.dwolla.v1.hal+json"
\ -H "Authorization: Bearer qe634nV7dIYpYDf3VGZPciziPU2BCboUZ7G7EG8XEyGswKkBV5"
\ "https://api.dwolla.com/customers/06B51D56-7A6C-4535-A0CC-2C0106F56BA6/iav-token"

HTTP/1.1 200 OK
{  
   "_links":{  
      "self":{  
         "href":"https://api.dwolla.com/customers/06b51d56-7a6c-4535-a0cc-2c0106f56ba6/iav-token"
      }
   },
   "token":"lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL"
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby><span class=n>customer_url</span> <span class=o>=</span> <span class=s1>'https://api-uat.dwolla.com/customers/06b51d56-7a6c-4535-a0cc-2c0106f56ba6'</span>

<span class=c1># Using DwollaV2 - https://github.com/Dwolla/dwolla-v2-ruby (Recommended)</span>
<span class=n>customer</span> <span class=o>=</span> <span class=n>account_token</span><span class=p>.</span><span class=nf>post</span> <span class=s2>"</span><span class=si>#{</span><span class=n>customer_url</span><span class=si>}</span><span class=s2>/iav-token"</span>
<span class=n>customer</span><span class=p>.</span><span class=nf>token</span> <span class=c1># =&gt; "lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL"</span>

<span class=c1># Using DwollaSwagger - https://github.com/Dwolla/dwolla-swagger-ruby</span>
<span class=n>customer</span> <span class=o>=</span> <span class=no>DwollaSwagger</span><span class=o>::</span><span class=no>CustomersApi</span><span class=p>.</span><span class=nf>get_customer_iav_token</span><span class=p>(</span><span class=n>customer_url</span><span class=p>)</span>
<span class=n>customer</span><span class=p>.</span><span class=nf>token</span> <span class=c1># =&gt; "lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL"</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript><span class=c1>// Using dwolla-v2 - https://github.com/Dwolla/dwolla-v2-node</span>
<span class=kd>var</span> <span class=nx>customerUrl</span> <span class=o>=</span> <span class=s1>'https://api-uat.dwolla.com/customers/06b51d56-7a6c-4535-a0cc-2c0106f56ba6'</span><span class=p>;</span>

<span class=nx>accountToken</span>
  <span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=err>`</span><span class=nx>$</span><span class=p>{</span><span class=nx>customerUrl</span><span class=p>}</span><span class=sr>/iav-token`</span><span class=err>)
</span>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>token</span><span class=p>;</span> <span class=c1>// =&gt; 'lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL'</span>
  <span class=p>});</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python><span class=n>customer_url</span> <span class=o>=</span> <span class=s>'http://api.dwolla.com/customers/06b51d56-7a6c-4535-a0cc-2c0106f56ba6'</span>
<span class=n>customers_api</span> <span class=o>=</span> <span class=n>dwollaswagger</span><span class=o>.</span><span class=n>CustomersApi</span><span class=p>(</span><span class=n>client</span><span class=p>)</span>

<span class=n>token</span> <span class=o>=</span> <span class=n>customers_api</span><span class=o>.</span><span class=n>get_customer_iav_token</span><span class=p>(</span><span class=n>customer_url</span><span class=p>)</span>
<span class=k>print</span> <span class=n>token</span><span class=p>[</span><span class=s>'token'</span><span class=p>]</span> <span class=c># =&gt; 'lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL'</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php><span class=cp>&lt;?php</span>
<span class=nv>$customersApi</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>DwollaSwagger\CustomersApi</span><span class=p>(</span><span class=nv>$apiClient</span><span class=p>);</span>

<span class=nv>$fsToken</span> <span class=o>=</span> <span class=nv>$customersApi</span><span class=o>-&gt;</span><span class=na>getCustomerIavToken</span><span class=p>(</span><span class=s2>"https://api-uat.dwolla.com/customers/06b51d56-7a6c-4535-a0cc-2c0106f56ba6"</span><span class=p>);</span>
<span class=nv>$fsToken</span><span class=o>-&gt;</span><span class=na>token</span><span class=p>;</span> <span class=c1># =&gt; "lr0Ax1zwIpeXXt8sJDiVXjPbwEeGO6QKFWBIaKvnFG0Sm2j7vL"
</span><span class=cp>?&gt;</span>
</code></pre></div></div><h3 id=step-2-include-dwolla-js-and-add-container-for-iav>Step 2: Include dwolla.js and add container for IAV</h3><p>We&rsquo;ll begin the client-side implementation by including dwolla.js in the HEAD of our HTML page. Notice, we are utilizing development version 1 of dwolla.js, alternatively you can include the minified version of <code>&lt;script src=&quot;https://cdn.dwolla.com/1/dwolla.min.js&quot;&gt;&lt;/script&gt;</code>.</p><div class="code-snippet js-code-snippet language-htmlnohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-htmlnohide data-lang=htmlnohide><span class=nt>&lt;head&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>"https://cdn.dwolla.com/1/dwolla.js"</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;/head&gt;</span>
</code></pre></div></div><p>Next, add the container to the body of the page where you want to render the IAV flow. Note: This container is responsive, meaning content is resized appropriately across all screen resolutions and devices.</p><div class="code-snippet js-code-snippet language-htmlnohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-htmlnohide data-lang=htmlnohide><span class=nt>&lt;div</span> <span class=na>id=</span><span class=s>"mainContainer"</span><span class=nt>&gt;</span>
    <span class=nt>&lt;input</span> <span class=na>type=</span><span class=s>"button"</span> <span class=na>id=</span><span class=s>"start"</span> <span class=na>value=</span><span class=s>"Add Bank"</span><span class=nt>&gt;</span>
<span class=nt>&lt;/div&gt;</span>  

<span class=nt>&lt;div</span> <span class=na>id=</span><span class=s>"iavContainer"</span><span class=nt>&gt;&lt;/div&gt;</span>
</code></pre></div></div><h3 id=step-3-configure-and-call-javascript-function-to-start-iav>Step 3: Configure and call JavaScript function to start IAV</h3><p>Now that you have initialized dwolla.js on your page you can configure and create the function that will call <code>dwolla.iav.start()</code>. For simplicity of this example, use jQuery and call the function to start IAV when the Customer clicks the &ldquo;Add Bank&rdquo; button on your page. To test IAV in the sandbox environment you will use the <code>dwolla.configure</code> helper function and pass in the value of <code>uat</code>. As you can see below, <code>dwolla.iav.start</code> takes three arguments: the iavContainer element where IAV will render, a string value of the single-use IAV token, and a callback function that will handle any error or response.</p><div class="code-snippet js-code-snippet language-javascriptnohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-javascriptnohide data-lang=javascriptnohide><span class=o>&lt;</span><span class=nx>script</span> <span class=nx>type</span><span class=o>=</span><span class=s2>"text/javascript"</span><span class=o>&gt;</span>
<span class=nx>$</span><span class=p>(</span><span class=s1>'#start'</span><span class=p>).</span><span class=nx>click</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>iavToken</span> <span class=o>=</span> <span class=s1>'4adF858jPeQ9RnojMHdqSD2KwsvmhO7Ti7cI5woOiBGCpH5krY'</span><span class=p>;</span>
  <span class=nx>dwolla</span><span class=p>.</span><span class=nx>configure</span><span class=p>(</span><span class=s1>'sandbox'</span><span class=p>);</span>
  <span class=nx>dwolla</span><span class=p>.</span><span class=nx>iav</span><span class=p>.</span><span class=nx>start</span><span class=p>(</span><span class=s1>'8zN400zyPUobbdmeNfhTGH2Jh5JkFREJa9YBI8SLXp0ERXNTMT'</span><span class=p>,</span> <span class=p>{</span>
  <span class=na>container</span><span class=p>:</span> <span class=s1>'iavContainer'</span><span class=p>,</span>
  <span class=na>stylesheets</span><span class=p>:</span> <span class=p>[</span>
    <span class=s1>'http://fonts.googleapis.com/css?family=Lato&amp;subset=latin,latin-ext'</span><span class=p>,</span>
    <span class=s1>'http://myapp.com/iav/someStylesheet.css'</span>
  <span class=p>],</span>
  <span class=na>microDeposits</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
  <span class=na>fallbackToMicroDeposits</span><span class=p>:</span> <span class=kc>false</span>
<span class=p>},</span> <span class=kd>function</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>'Error: '</span> <span class=o>+</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=o>+</span> <span class=s1>' -- Response: '</span> <span class=o>+</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>res</span><span class=p>));</span>
<span class=p>});</span>
<span class=p>});</span>
<span class=o>&lt;</span><span class=sr>/script</span><span class=err>&gt;
</span></code></pre></div></div><p>In order to facilitate testing IAV in the Sandbox, we allow you to specify any value in the IAV text field inputs to proceed through the flow.</p><h3 id=step-4-handle-the-error-or-response>Step 4: Handle the error or response</h3><p>The callback function (err, res) allows you to determine if there is an error with the request (i.e. <code>InvalidIavToken</code>) or if the response was successful.</p><ul><li>If there is an error: generate a new IAV token and re-attempt the IAV flow.<ul><li>Example: <code>{code: &quot;InvalidIavToken&quot;, message: &quot;Invalid IAV token.&quot; }</code></li></ul></li><li>If successful: You will receive a JSON response that includes a link to the newly created and verified funding source. You can then pass this value to either initiate a transfer or store the created resource in your database to be used later.<ul><li>Example: <code>{&quot;_links&quot;:{&quot;funding-source&quot;:{&quot;href&quot;:&quot;https://api-uat.dwolla.com/funding-sources/80275e83-1f9d-4bf7-8816-2ddcd5ffc197&quot;}}}</code></li></ul></li></ul><hr><h4 id=view>View:</h4><ul><li><a href=/resources/dwolla-js/instant-account-verification.html>Dwolla.js - Instant account verification</a></li></ul><hr><section class=copyright><div class=page-wrap><div><span>© 2017 HAT Data Exchange Ltd.</span> <a href="https://hubofallthings.com/main/cookie-policy/">Cookie Policy</a></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.44e4.js></script></body></html>